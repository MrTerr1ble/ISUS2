<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Система Управления Складами (ИСУС)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="/styles.css" />
</head>
<body>
  <div class="container">
    <div class="sidebar" id="sidebar">
      <div class="logo">ИСУС</div>
      <button class="nav-button active" onclick="showPage('dashboard')"><i class="fas fa-tachometer-alt"></i> Дашборд склада</button>
      <button class="nav-button" onclick="showPage('input-ore')"><i class="fas fa-cubes"></i> Партии руды</button>
      <button class="nav-button" onclick="showPage('input-equipment')"><i class="fas fa-truck-monster"></i> Оборудование</button>
      <button class="nav-button" onclick="showPage('orders')"><i class="fas fa-file-signature"></i> Заказы и продажи</button>
      <button class="nav-button" onclick="showPage('shipments')"><i class="fas fa-truck"></i> Отгрузки</button>
      <button class="nav-button" onclick="showPage('reports')"><i class="fas fa-chart-bar"></i> Аналитика</button>
      <button class="nav-button" onclick="showPage('logs')"><i class="fas fa-history"></i> Логи</button>
    </div>
    <div class="content" id="content">
      <div class="menu-right">
        <div class="toggle-sidebar" onclick="toggleSidebar()"><i class="fas fa-bars"></i></div>
        <div class="icon" onclick="toggleTheme()"><i class="fas fa-moon"></i></div>
        <div class="icon"><i class="fas fa-bell"></i></div>
        <div class="icon"><i class="fas fa-user"></i></div>
      </div>

      <!-- 1. Дашборд склада -->
      <div id="dashboard" class="page active">
        <div class="title">Дашборд склада</div>
        <div class="block chart-placeholder">Диаграмма распределения партий по складам</div>
        <input class="input search-input" type="text" placeholder="Поиск по таблице..." onkeyup="filterTable(this, 'dashboard-table')">
        <table class="table" id="dashboard-table">
          <thead>
            <tr>
              <th>Партия</th>
              <th>Тип руды</th>
              <th>Склад</th>
              <th>Кол-во</th>
              <th>Ед.</th>
              <th>Качество</th>
              <th>Статус</th>
            </tr>
          </thead>
          <tbody id="dashboard-batches-body"></tbody>
        </table>
        <div class="button" onclick="showPage('input-ore')"><i class="fas fa-plus"></i> Добавить партию руды</div>
        <div class="button" onclick="showPage('input-equipment')"><i class="fas fa-plus"></i> Добавить оборудование</div>
      </div>

      <!-- 2. Партии руды -->
      <div id="input-ore" class="page">
        <div class="title">Учет партий руды</div>
        <form class="form-group" id="ore-form" onsubmit="event.preventDefault(); saveOreBatch();">
          <div class="block">
            <label>Тип руды:</label>
            <select class="select" name="ore_type_id" id="ore-type-select" required></select>
          </div>
          <div class="block">
            <label>Склад хранения:</label>
            <select class="select" name="warehouse_id" id="ore-warehouse-select" required></select>
          </div>
          <div class="block">
            <label>Код партии:</label>
            <input class="input" type="text" name="batch_code" placeholder="Например, RU-2025-001" />
          </div>
          <div class="block">
            <label>Количество:</label>
            <input class="input" type="number" step="0.01" min="0" name="quantity" placeholder="Введите количество" required />
          </div>
          <div class="block">
            <label>Единица измерения:</label>
            <select class="select" name="unit_id" id="ore-unit-select" required></select>
          </div>
          <div class="block">
            <label>Качество (%):</label>
            <input class="input" type="number" step="0.01" min="0" max="100" name="quality" placeholder="Например, 65" />
          </div>
          <div class="block">
            <label>Приоритет:</label>
            <select class="select" name="priority">
              <option value="Стандарт">Стандарт</option>
              <option value="Высокий">Высокий</option>
              <option value="Критический">Критический</option>
            </select>
          </div>
          <div class="block">
            <label>Дата добычи:</label>
            <input class="input" type="date" name="extraction_date" />
          </div>
          <div class="block">
            <label>Статус партии:</label>
            <select class="select" name="status">
              <option value="На складе">На складе</option>
              <option value="Зарезервирована">Зарезервирована</option>
              <option value="Отгружена">Отгружена</option>
            </select>
          </div>
          <div class="button" onclick="saveOreBatch()"><i class="fas fa-save"></i> Сохранить партию</div>
        </form>
        <div class="block">
          <div class="title">Текущие партии</div>
          <input class="input search-input" type="text" placeholder="Поиск по партиям..." onkeyup="filterTable(this, 'ore-batch-table')">
          <table class="table" id="ore-batch-table">
            <thead>
              <tr>
                <th>Партия</th>
                <th>Тип руды</th>
                <th>Склад</th>
                <th>Кол-во</th>
                <th>Ед.</th>
                <th>Качество</th>
                <th>Приоритет</th>
                <th>Статус</th>
              </tr>
            </thead>
            <tbody id="ore-batches-table-body"></tbody>
          </table>
        </div>
      </div>

      <!-- 3. Оборудование -->
      <div id="input-equipment" class="page">
        <div class="title">Оборудование и техника</div>
        <form class="form-group" id="equipment-form" onsubmit="event.preventDefault(); saveEquipment();">
          <div class="block">
            <label>Наименование:</label>
            <input class="input" type="text" name="name" placeholder="Например, Экскаватор" required />
          </div>
          <div class="block">
            <label>Категория:</label>
            <select class="select" name="category_id" id="equipment-category-select" required></select>
          </div>
          <div class="block">
            <label>Склад эксплуатации:</label>
            <select class="select" name="warehouse_id" id="equipment-warehouse-select" required></select>
          </div>
          <div class="block">
            <label>Количество:</label>
            <input class="input" type="number" step="1" min="0" name="quantity" placeholder="Введите количество" required />
          </div>
          <div class="block">
            <label>Единица учета:</label>
            <select class="select" name="unit_id" id="equipment-unit-select" required></select>
          </div>
          <div class="block">
            <label>Серийный номер:</label>
            <input class="input" type="text" name="serial_number" placeholder="SN-0001" />
          </div>
          <div class="block">
            <label>Срок службы (мес):</label>
            <input class="input" type="number" min="0" name="service_life_months" />
          </div>
          <div class="block">
            <label>Статус:</label>
            <select class="select" name="status">
              <option value="В эксплуатации">В эксплуатации</option>
              <option value="На обслуживании">На обслуживании</option>
              <option value="Списано">Списано</option>
            </select>
          </div>
          <div class="block">
            <label>Дата ввода:</label>
            <input class="input" type="date" name="purchase_date" />
          </div>
          <div class="button" onclick="saveEquipment()"><i class="fas fa-save"></i> Сохранить оборудование</div>
        </form>
        <div class="block">
          <div class="title">Реестр оборудования</div>
          <input class="input search-input" type="text" placeholder="Поиск по оборудованию..." onkeyup="filterTable(this, 'equipment-table')">
          <table class="table" id="equipment-table">
            <thead>
              <tr>
                <th>Наименование</th>
                <th>Категория</th>
                <th>Склад</th>
                <th>Кол-во</th>
                <th>Ед.</th>
                <th>Статус</th>
                <th>Серийный №</th>
              </tr>
            </thead>
            <tbody id="equipment-table-body"></tbody>
          </table>
        </div>
      </div>

      <!-- 4. Заказы и продажи -->
      <div id="orders" class="page">
        <div class="title">Заказы на реализацию</div>
        <form class="form-group" id="order-form" onsubmit="event.preventDefault(); saveOrder();">
          <div class="block">
            <label>Номер заказа:</label>
            <input class="input" type="text" name="order_number" placeholder="Например, SO-2025-001" required />
          </div>
          <div class="block">
            <label>Покупатель:</label>
            <select class="select" name="contractor_id" id="contractor-select" required></select>
          </div>
          <div class="block">
            <label>Склад отгрузки:</label>
            <select class="select" name="warehouse_id" id="order-warehouse-select" required></select>
          </div>
          <div class="block">
            <label>Дата заказа:</label>
            <input class="input" type="date" name="order_date" />
          </div>
          <div class="block">
            <label>Статус:</label>
            <select class="select" name="status">
              <option value="Черновик">Черновик</option>
              <option value="Подтвержден">Подтвержден</option>
              <option value="Отгружен">Отгружен</option>
              <option value="Закрыт">Закрыт</option>
            </select>
          </div>
          <div class="block" style="width: 100%;">
            <label>Позиции заказа:</label>
            <div id="order-items"></div>
            <div class="button secondary" onclick="addOrderItemRow();"><i class="fas fa-plus"></i> Добавить позицию</div>
          </div>
          <div class="button" onclick="saveOrder()"><i class="fas fa-save"></i> Сохранить заказ</div>
        </form>
        <div class="block">
          <div class="title">Список заказов</div>
          <input class="input search-input" type="text" placeholder="Поиск по заказам..." onkeyup="filterTable(this, 'orders-table')">
          <table class="table" id="orders-table">
            <thead>
              <tr>
                <th>Номер</th>
                <th>Покупатель</th>
                <th>Склад</th>
                <th>Статус</th>
                <th>Дата</th>
                <th>Объем</th>
              </tr>
            </thead>
            <tbody id="orders-table-body"></tbody>
          </table>
        </div>
      </div>

      <!-- 5. Отгрузки -->
      <div id="shipments" class="page">
        <div class="title">Отгрузки</div>
        <form class="form-group" id="shipment-form" onsubmit="event.preventDefault(); saveShipment();">
          <div class="block">
            <label>Заказ:</label>
            <select class="select" name="order_id" id="shipment-order-select" required></select>
          </div>
          <div class="block">
            <label>Транспорт:</label>
            <select class="select" name="transport_id" id="shipment-transport-select"></select>
          </div>
          <div class="block">
            <label>Плановая дата:</label>
            <input class="input" type="date" name="planned_date" />
          </div>
          <div class="block">
            <label>Фактическая дата:</label>
            <input class="input" type="date" name="actual_date" />
          </div>
          <div class="block">
            <label>Статус:</label>
            <select class="select" name="status">
              <option value="Планируется">Планируется</option>
              <option value="В пути">В пути</option>
              <option value="Завершена">Завершена</option>
            </select>
          </div>
          <div class="button" onclick="saveShipment()"><i class="fas fa-save"></i> Сохранить отгрузку</div>
        </form>
        <div class="block">
          <div class="title">Журнал отгрузок</div>
          <input class="input search-input" type="text" placeholder="Поиск по отгрузкам..." onkeyup="filterTable(this, 'shipments-table')">
          <table class="table" id="shipments-table">
            <thead>
              <tr>
                <th>Номер заказа</th>
                <th>Транспорт</th>
                <th>Плановая дата</th>
                <th>Фактическая дата</th>
                <th>Статус</th>
              </tr>
            </thead>
            <tbody id="shipments-table-body"></tbody>
          </table>
        </div>
      </div>

      <!-- 6. Аналитика -->
      <div id="reports" class="page">
        <div class="title">Аналитика и отчеты</div>
        <div class="block">
          <label>Фильтры:</label>
          <div style="display: flex; gap: 10px; flex-wrap: wrap;">
            <select class="select" id="reports-warehouse-filter"></select>
            <select class="select" id="reports-oretype-filter"></select>
            <input class="input" type="month" id="reports-period" />
          </div>
        </div>
        <div class="block chart-placeholder">График отгрузок по месяцам</div>
        <div class="block chart-placeholder">График остатков по складам</div>
        <div class="block">
          <div class="title">Сводные показатели</div>
          <table class="table" id="reports-table">
            <thead>
              <tr>
                <th>Показатель</th>
                <th>Значение</th>
              </tr>
            </thead>
            <tbody id="reports-table-body"></tbody>
          </table>
        </div>
        <div class="button" onclick="alert('Отчёт сформирован!')"><i class="fas fa-file-alt"></i> Сформировать отчёт</div>
        <div class="button" onclick="alert('Экспортировано в Excel!')"><i class="fas fa-file-excel"></i> Экспорт в Excel</div>
        <div class="button" onclick="alert('Экспортировано в PDF!')"><i class="fas fa-file-pdf"></i> Экспорт в PDF</div>
      </div>

      <!-- 7. Логи -->
      <div id="logs" class="page">
        <div class="title">Логи действий</div>
        <input class="input search-input" type="text" placeholder="Поиск по логам..." onkeyup="filterTable(this, 'logs-table')">
        <table class="table" id="logs-table">
          <thead>
            <tr>
              <th>Дата и время</th>
              <th>Пользователь</th>
              <th>Действие</th>
              <th>Сущность</th>
              <th>Подробности</th>
            </tr>
          </thead>
          <tbody id="logs-table-body"></tbody>
        </table>
      </div>
    </div>
  </div>
  <script src="/script.js"></script>
</body>
</html>
